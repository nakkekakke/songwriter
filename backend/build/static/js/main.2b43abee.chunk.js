(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{103:function(e,t,n){e.exports=n(137)},108:function(e,t,n){},137:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(9),c=n.n(o),i=(n(108),n(25)),l=n(43),u=n(169),s=n(171),d=n(89),m=n(172),f=n(167),p=Object(f.a)((function(){return{root:{flexGrow:1},title:{fontSize:20,paddingRight:15},buttonsDiv:{flex:1},linkButton:{textDecoration:"none",color:"white",padding:20}}})),g=function(){var e=p();return r.a.createElement("div",{className:e.root},r.a.createElement(u.a,{position:"static"},r.a.createElement(s.a,null,r.a.createElement(d.a,{className:e.title},"SongWriter"),r.a.createElement("div",{className:e.buttonsDiv},r.a.createElement(m.a,{component:l.b,to:"/songs/",color:"inherit",className:e.linkButton},"Your songs")),r.a.createElement(m.a,{color:"inherit",className:e.logout},"Logout"))))},E=n(179),v=n(13),b=n(174),h=n(173),O=Object(f.a)((function(){return{item:{}}})),j=function(e){var t=e.song,n=O();return r.a.createElement(h.a,{component:l.b,to:"/songs/".concat(t.id),divider:!0,className:n.item},r.a.createElement("h2",null,t.title))},S=n(20),N=n(175),w=n(39),y=function(e){var t=e.match(/[^\r\n]+/g);return t||[]},x=function(){return{title:"New song",sections:[{id:1,name:"New section",lines:[]}]}},C=function(e){for(var t="",n=0;n<e.length;n++)t=t.concat(e[n]),n+1<e.length&&(t=t.concat("\n"));return t},k=function(e){return y(e).map((function(e){return e.trim()})).filter((function(e){return""!==e}))},D=function(e){return y(e).size},I=x,T=function(e){if(0===e.sections.length)return e.sections=[{id:1,name:"New section",lines:[]}],e;var t=e.sections.reduce((function(e,t){return t.id>e.id?t:e})).id;console.log(t);var n=Object(w.a)(Object(w.a)({},{id:1,name:"New section",lines:[]}),{},{id:t+1});return e.sections.push(n),e},B=n(10),_=n.n(B),G=n(18),A=n(49),M=n.n(A),W="/api/songs/",L={getAll:function(){var e=Object(G.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting songs..."),e.next=3,M.a.get(W);case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(G.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.a.get(W+t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(G.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Creating new song..."),e.next=3,M.a.post(W,t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),edit:function(){var e=Object(G.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Editing song: ",t),e.next=3,M.a.put(W+t.id,t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),destroy:function(){var e=Object(G.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Deleting song with id:",t),e.next=3,M.a.delete(W+t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_SONGS":return t.data;case"CREATE_SONG":var n=e.concat(t.data);return n;case"EDIT_SONG":console.log("Editing song:",t.data);var a=t.data.id;return e.map((function(e){return e.id!==a?e:t.data}));case"DELETE_SONG":return e.filter((function(e){return e.id!==t.data.id}));case"EDIT_SECTION":var r=t.data.songId,o=t.data.section.id,c=e.find((function(e){return e.id===r})),i=c.sections.map((function(e){return e.id!==o?e:t.data.section}));return e.map((function(e){return e.id!==r?e:Object(w.a)(Object(w.a)({},c),{},{sections:i})}));case"DELETE_SECTION":var l=t.data.songId,u=t.data.section.id,s=e.find((function(e){return e.id===l})),d=s.sections.filter((function(e){return e.id!==u}));return e.map((function(e){return e.id!==l?e:Object(w.a)(Object(w.a)({},s),{},{sections:d})}));default:return console.log("Default in reducer"),e}},R=Object(f.a)((function(){return{root:{},addSongButton:{margin:8}}})),F=function(){var e=R(),t=Object(S.c)((function(e){return e})),n=Object(S.b)(),a=Object(v.f)();console.log("Rendered",t.length,"songs");return r.a.createElement("div",{className:e.root},r.a.createElement("h1",null,"Songs"),r.a.createElement(b.a,null,0!==t.length?t.map((function(e){return r.a.createElement(j,{key:e.id,to:"/songs/".concat(e.id),song:e})})):r.a.createElement("p",null,"No songs found")),r.a.createElement(m.a,{className:e.addSongButton,variant:"contained",color:"primary",startIcon:r.a.createElement(N.a,null),onClick:function(){var e;n((e=I(),function(){var t=Object(G.a)(_.a.mark((function t(n){var a;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L.create(e);case 3:return a=t.sent,console.log("Created:",a),n({type:"CREATE_SONG",data:a}),t.abrupt("return",a);case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}())).then((function(e){a.push("/songs/"+e.id),console.log("Redirected!")})).catch((function(e){return console.log("Error creating new song:",e)}))}},"New song"))},z=n(186),V=n(190),H=n(181),Y=n(182),q=n(183),K=n(184),P=n(180),Q=n(187),U=n(176),X=n(53),Z=n(177),$=Object(f.a)((function(e){return{section:{borderWidth:2,borderStyle:"solid",borderRadius:5,borderColor:e.palette.primary.main,padding:20,marginBottom:3,overflow:"auto",whiteSpace:"nowrap",backgroundColor:"#fff"},normalViewRoot:{marginTop:-12,marginBottom:-15},line:{marginTop:-5},editForm:{marginBottom:15},nameField:{marginBottom:10},buttonDiv:{display:"flex"},lineSubmitButton:{marginTop:10,marginBottom:-25},deleteButton:{marginTop:10,marginBottom:-25,marginLeft:"auto"},dragHandle:{marginLeft:"auto",marginTop:10,marginBottom:-25}}})),ee=function(e){var t=e.songId,n=e.section,o=e.editMode,c=Object(a.useState)(n.name),l=Object(i.a)(c,2),u=l[0],s=l[1],d=Object(a.useState)(C(n.lines)),f=Object(i.a)(d,2),p=f[0],g=f[1],E=Object(a.useState)(!1),v=Object(i.a)(E,2),b=v[0],h=v[1],O=$(),j=Object(S.b)(),N=Object(X.c)((function(){return r.a.createElement(Q.a,{className:O.dragHandle}," ",r.a.createElement(U.a,null,r.a.createElement(Z.a,null))," ")})),w=function(e){e.preventDefault(),console.log("Submitting name:",u);var a=k(p),r={id:n.id,name:u,lines:a};j(function(e,t){return function(){var n=Object(G.a)(_.a.mark((function n(a){return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"EDIT_SECTION",data:{songId:e,section:t}});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,r));var o=C(a);e.target.lines.value=o,g(o)},y=function(e){s(e.target.value)},x=function(e){g(e.target.value)},I=function(e){e.preventDefault(),console.log("Delete button pressed!"),b?(console.log("Delete for realz"),j(function(e,t){return function(){var n=Object(G.a)(_.a.mark((function n(a){return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"DELETE_SECTION",data:{songId:e,section:t}});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n))):h(!0)};return r.a.createElement("div",{className:O.section},o?r.a.createElement("form",{className:O.editForm,onSubmit:w},r.a.createElement(z.a,{className:O.nameField,label:"Edit name",name:"name",defaultValue:u,onChange:y}),r.a.createElement("div",null,r.a.createElement(z.a,{multiline:!0,label:"Lines",name:"lines",rows:D(p),defaultValue:p,onChange:x,fullWidth:!0})),r.a.createElement("div",{className:O.buttonDiv},r.a.createElement(m.a,{className:O.lineSubmitButton,size:"small",color:"primary",variant:"outlined",type:"submit"},"Save"),r.a.createElement(N,null),r.a.createElement(m.a,{className:O.deleteButton,size:"small",color:"secondary",variant:"outlined",onClick:I},b?"Confirm deletion":"Delete"))):r.a.createElement("div",{className:O.normalViewRoot},r.a.createElement("h2",null,n.name),n.lines.map((function(e,t){return r.a.createElement("p",{className:O.line,key:t},e)}))))},te=n(85),ne=n.n(te),ae=Object(f.a)((function(){return{root:{}}})),re=Object(X.b)((function(e){var t=e.section,n=e.song,a=e.editMode;return r.a.createElement(ee,{songId:n.id,section:t,editMode:a})})),oe=Object(X.a)((function(e){var t=e.song,n=e.editMode;return r.a.createElement(E.a,{maxWidth:!1,align:"left"},t.sections.map((function(e,a){return r.a.createElement(re,{key:e.id,index:a,section:e,song:t,editMode:n})})))})),ce=function(e){var t=e.song,n=e.editMode,a=Object(S.b)(),o=(ae(),function(e){var n=e.oldIndex,r=e.newIndex,o=ne()(t.sections,n,r);a(function(e,t){var n=JSON.parse(JSON.stringify(e));return n.sections=t,function(){var e=Object(G.a)(_.a.mark((function e(t){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"EDIT_SONG",data:n});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(t,o))});return 0===t.sections.length?r.a.createElement(E.a,null,r.a.createElement("h2",null,"No sections")):r.a.createElement(oe,{song:t,editMode:n,onSortEnd:o,useDragHandle:!0,useWindowAsScrollContainer:!0})},ie=Object(f.a)((function(){return{root:{},menuContainer:{marginBottom:3},titleForm:{margin:15},addSectionButton:{marginTop:8},deleteSongButton:{marginLeft:"auto"}}})),le=function(e){var t=e.setAlertMessage,n=e.setAlertIsError,o=Object(a.useState)(!1),c=Object(i.a)(o,2),l=c[0],u=c[1],s=Object(a.useState)(""),d=Object(i.a)(s,2),f=d[0],p=d[1],g=Object(a.useState)(!1),b=Object(i.a)(g,2),h=b[0],O=b[1],j=Object(a.useState)(!1),w=Object(i.a)(j,2),y=w[0],x=w[1],C=ie(),k=Object(v.g)().id,D=Object(S.b)(),I=Object(v.f)(),B=Object(S.c)((function(e){return e.find((function(e){return e.id===Number(k)}))}));console.log("Song render:",B);console.log("Delconfirmopen:",h);var A=function(){console.log("Exiting edit mode"),x(!0)},M=function(){console.log("Saving!"),x(!1),u(!1),D(function(e){return function(){var t=Object(G.a)(_.a.mark((function t(n){var a;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L.edit(e);case 3:a=t.sent,n({type:"EDIT_SONG",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(B))},W=function(){console.log("Discarding changes!"),x(!1),u(!1),D(function(e){return function(){var t=Object(G.a)(_.a.mark((function t(n){var a;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L.getOne(e.id);case 3:a=t.sent,n({type:"EDIT_SONG",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(B))},J=function(e){console.log(e.target.value),p(e.target.value)},R=function(e){e.preventDefault(),D(function(e,t){var n=JSON.parse(JSON.stringify(e));return n.title=t,function(){var e=Object(G.a)(_.a.mark((function e(t){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"EDIT_SONG",data:n});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(B,f)),n(!1),t("Song title changed to: "+f)},F=function(){console.log("Add new section!"),D(function(e){var t=JSON.parse(JSON.stringify(e));return t=T(t),function(){var e=Object(G.a)(_.a.mark((function e(n){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"EDIT_SONG",data:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(B))},Q=function(){console.log("Deleting song here"),D(function(e){return function(){var t=Object(G.a)(_.a.mark((function t(n){var a;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L.destroy(e.id);case 3:a=t.sent,console.log("Destroy returned:",a),n({type:"DELETE_SONG",data:e}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(B)),I.push("/songs/")};return B?r.a.createElement("div",{className:C.root},l?r.a.createElement("form",{onSubmit:R,className:C.titleForm},r.a.createElement(z.a,{label:"Edit title",defaultValue:f||B.title,onChange:J})):r.a.createElement("h1",null,B.title),r.a.createElement("div",null,r.a.createElement(E.a,{align:"right",maxWidth:!1,className:C.menuContainer},r.a.createElement(m.a,{color:"primary",variant:"contained",onClick:function(){l?A():u(!0)}},l?"Exit edit mode":"Edit mode")),r.a.createElement(ce,{song:B,editMode:l})),r.a.createElement(E.a,{maxWidth:!1},l?r.a.createElement(m.a,{className:C.addSectionButton,variant:"contained",color:"primary",startIcon:r.a.createElement(N.a,null),onClick:F},"New section"):r.a.createElement("div",null)),r.a.createElement(E.a,{align:"right",maxWidth:!1},l?r.a.createElement(m.a,{className:C.deleteSongButton,variant:"contained",color:"secondary",startIcon:r.a.createElement(P.a,null),onClick:function(){return O(!0)}},"Delete song"):r.a.createElement("div",null)),r.a.createElement(V.a,{open:h,onClose:function(){return O(!1)}},r.a.createElement(H.a,null,"Delete this song?"),r.a.createElement(Y.a,null,r.a.createElement(q.a,null,"Once deleted, this song cannot be restored (not even by discarding changes when exiting Edit Mode).")),r.a.createElement(K.a,null,r.a.createElement(m.a,{onClick:Q,color:"secondary",variant:"contained"},"Delete permanently"),r.a.createElement(m.a,{onClick:function(){return O(!1)},variant:"contained"},"Cancel"))),r.a.createElement(V.a,{open:y,onClose:function(){return x(!1)}},r.a.createElement(H.a,null,"Save changes?"),r.a.createElement(Y.a,null,r.a.createElement(q.a,null,"Save or discard the changes you have made.")),r.a.createElement(K.a,null,r.a.createElement(m.a,{onClick:M,color:"primary",variant:"contained"},"Save changes"),r.a.createElement(m.a,{onClick:W,color:"secondary",variant:"contained"},"Discard changes"),r.a.createElement(m.a,{onClick:function(){return x(!1)},variant:"contained"},"Cancel")))):r.a.createElement("div",null,r.a.createElement("h1",null,"Loading"),r.a.createElement("p",null,"Check the url if it takes too long"))},ue=n(191),se=n(188),de=function(e){var t=e.message,n=e.isError,a=e.handleClose;return r.a.createElement("div",null,r.a.createElement(ue.a,{open:""!==t,autoHideDuration:5e3,onClose:a},r.a.createElement(se.a,{variant:"filled",onClose:a,severity:n?"error":"success"},t)))},me=Object(f.a)((function(){return{mainContainer:{justifyContent:"center",alignItems:"center",padding:20},contentContainer:{}}})),fe=function(){console.log("App render");var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),u=Object(i.a)(c,2),s=u[0],d=u[1],m=me(),f=Object(S.b)();Object(a.useEffect)((function(){console.log("App effect"),f(function(){var e=Object(G.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.getAll();case 3:n=e.sent,console.log("Initialized:",n),t({type:"INIT_SONGS",data:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())}),[f]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,null,r.a.createElement(g,null),r.a.createElement(E.a,{maxWidth:!1,className:m.mainContainer},r.a.createElement(E.a,{maxWidth:!1,align:"center",className:m.contentContainer},r.a.createElement(v.c,null,r.a.createElement(v.a,{path:"/songs/:id"},r.a.createElement(le,{setAlertMessage:o,setAlertIsError:d})),r.a.createElement(v.a,{path:"/songs/"},r.a.createElement(F,null)),r.a.createElement(v.a,{path:"/"},r.a.createElement("p",null,"Welcome")))),r.a.createElement(de,{message:n,isError:s,handleClose:function(e,t){"clickaway"!==t&&o("")}}))))},pe=n(185),ge=n(44),Ee=n(86),ve=n(87),be=Object(ve.composeWithDevTools)({trace:!0}),he=Object(ge.createStore)(J,be(Object(ge.applyMiddleware)(Ee.a)));c.a.render(r.a.createElement(pe.a,null,r.a.createElement(S.a,{store:he},r.a.createElement(fe,null))),document.getElementById("root"))}},[[103,1,2]]]);
//# sourceMappingURL=main.2b43abee.chunk.js.map