(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[1],{12:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return o}));var r=n(3),a={authFailure:{message:"Authentication failed. Please log in again.",type:"error"},authSuccess:{message:"Authentication succeeded.",type:"success"},loginSuccess:{message:"Logged in.",type:"success"},loginFailure:{message:"Invalid credentials.",type:"error"},welcome:{message:"Welcome!",type:"success"},songCreated:{message:"Song created.",type:"success"},songSaved:{message:"Song saved.",type:"success"},logout:{message:"Logged out.",type:"success"},signupSuccess:{message:"Signup successful! You can now log in.",type:"success"},signupFailure:{message:"Username is already taken!",type:"error"},validationFailure:{message:"Saving failed due to invalid input data.",type:"error"},serverFailure:{message:"Error communicating with the server. Check your internet connection and try again.",type:"error"},dataDesync:{message:"Local data differs from server data. Please refresh the page.",type:"error"}},c={message:"",type:"",open:!1},u=function(e){return{type:"SHOW_ALERT",data:Object(r.a)({},e)}},o=function(){return{type:"HIDE_ALERT"}};t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_ALERT":return Object(r.a)(Object(r.a)({},t.data),{},{open:!0});case"HIDE_ALERT":return Object(r.a)(Object(r.a)({},e),{},{open:!1});default:return e}}},140:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(14),u=n.n(c),o=(n(98),n(4)),i=n.n(o),s=n(9),d=n(19),l=n(23),f=n(164),p=n(166),g=n(168),O=n(169),E=Object(f.a)((function(){return{root:{marginTop:114},text:{marginBottom:15}}})),v=function(){var e=E();return a.a.createElement("div",null,a.a.createElement(p.a,{align:"center",className:e.root},a.a.createElement(g.a,{component:"h1",variant:"h4",className:e.text},"Loading"),a.a.createElement(O.a,{size:70,thickness:4})))},S=n(176),m=n(175),h=n(12),b=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.alert})),n=function(t,n){"clickaway"!==n&&e(Object(h.c)())};return a.a.createElement(S.a,{open:t.open,autoHideDuration:5e3,onClose:n,style:{marginBottom:5}},a.a.createElement(m.a,{variant:"filled",onClose:n,severity:t.type},t.message))},y=n(174),T=n(85),_=n(173),j=a.a.lazy(Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(0),n.e(4),n.e(5)]).then(n.bind(null,254));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),N=a.a.lazy(Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(0),n.e(6)]).then(n.bind(null,255));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),I=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.auth.user})),n=Object(d.c)((function(e){return e.statuses.darkMode}));Object(r.useEffect)((function(){var t=localStorage.getItem("SongWriterUser");if(t){var n=JSON.parse(t);e(Object(l.d)(n))}}),[e]);var c=Object(T.a)({}),u=Object(T.a)({palette:{type:"dark",background:{default:"#000"},primary:{main:"#354599",dark:"#263271",light:c.palette.primary.main},secondary:{main:"#84002f",dark:"#620023",light:c.palette.primary.main}}});return a.a.createElement(_.a,{theme:n?u:c},a.a.createElement(y.a,null,a.a.createElement(r.Suspense,{fallback:a.a.createElement(v,null)},t?a.a.createElement(j,null):a.a.createElement(N,null)),a.a.createElement(b,null)))},R=n(27);u.a.render(a.a.createElement(d.a,{store:R.a},a.a.createElement(I,null)),document.getElementById("root"))},23:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return O}));var r=n(4),a=n.n(r),c=n(9),u=n(3),o=n(39),i=n.n(o),s={authenticate:function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.post("/api/token",{username:t,password:n});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},d=n(12),l={loginInProgress:!1,loggedIn:!1,user:null},f=function(e,t){return console.log("logging in user:",e),function(){var n=Object(c.a)(a.a.mark((function n(r){var c;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:"LOGIN_REQUEST",data:{username:e,password:t}}),n.prev=1,n.next=4,s.authenticate(e,t);case 4:c=n.sent,localStorage.setItem("SongWriterUser",JSON.stringify(c)),r({type:"LOGIN_SUCCESS",data:c}),r(Object(d.d)(d.a.loginSuccess)),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),console.log("Login failed"),r({type:"LOGIN_FAILURE"}),r(Object(d.d)(d.a.loginFailure));case 15:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e){return n.apply(this,arguments)}}()},p=function(e){return console.log("auto-login for",e),{type:"LOGIN_WITH_TOKEN",data:e}},g=function(){return localStorage.removeItem("SongWriterUser"),{type:"LOGOUT_SUCCESS"}},O=function(){return localStorage.removeItem("SongWriterUser"),{type:"AUTH_FAILURE"}};t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_REQUEST":return Object(u.a)(Object(u.a)({},e),{},{loginInProgress:!0});case"LOGIN_SUCCESS":return{loginInProgress:!1,loggedIn:!0,user:t.data};case"LOGIN_FAILURE":return l;case"LOGIN_WITH_TOKEN":return{loginInProgress:!1,loggedIn:!0,user:t.data};case"LOGOUT_SUCCESS":case"AUTH_FAILURE":return l;default:return e}}},27:function(e,t,n){"use strict";var r=n(21),a=n(82),c=n(83),u=n(55),o=n(77),i=n(23),s=n(12),d=n(62),l=n(59),f=Object(c.composeWithDevTools)({trace:!0}),p=Object(r.combineReducers)({songs:u.e,snapshot:o.a,auth:i.b,alert:s.b,errors:d.b,statuses:l.a}),g=Object(r.createStore)(p,f(Object(r.applyMiddleware)(a.a)));t.a=g},52:function(e,t,n){"use strict";var r=n(25),a=n(3),c=n(0),u=n.n(c),o=n(164),i=Object(o.a)((function(e){return{chord:{backgroundColor:e.palette.grey[400],marginBottom:-20,marginLeft:1,marginRight:1,padding:1,paddingLeft:3,paddingRight:3,borderColor:e.palette.primary.main,borderWidth:2,borderStyle:"solid",borderRadius:5,display:"inline-block",fontSize:"85%",color:e.palette.common.black}}})),s=function(e){var t=e.chordString,n=i();return u.a.createElement("span",{className:n.chord},t)},d=n(84),l=n.n(d),f=function(e){var t=e.match(/[^\r\n]+/g);return t||[]},p=function(){return{id:1,name:"New section",lines:[]}},g=function(e){return 0===e.sections.length?1:e.sections.map((function(e){return e.id})).reduce((function(e,t){return t>e?t:e}))+1},O=function(e){return 0===e.sections.length?p():Object(a.a)(Object(a.a)({},p()),{},{id:g(e)})};t.a={linesArrayToString:function(e){for(var t="",n=0;n<e.length;n++)t=t.concat(e[n]),n+1<e.length&&(t=t.concat("\n"));return t},linesStringToArray:function(e){return f(e)},lineCount:function(e){return f(e).size},getDefaultSong:function(e){return{title:"New song",sections:[p()],username:e?e.username:null}},addNewSection:function(e){var t=O(e);return e.sections.push(t),e},createNewSection:O,cloneAndAddSection:function(e,t){var n=Object(a.a)(Object(a.a)({},t),{},{id:g(e)});return Object(a.a)(Object(a.a)({},e),{},{sections:[].concat(Object(r.a)(e.sections),[n])})},validateLines:function(e){for(var t=0;t<e.length;t++)if(e[t].length>200)return!1;return!0},addChordsToLine:function(e){var t=e.match(/\[([^\]]+)\]/gm),n=e.replace(/ /g,"\xa0");if(t)for(var r=function(e){n=l()(n,t[e],(function(n,r){return u.a.createElement(s,{key:t[e]+r,chordString:n.substring(1,n.length-1)})}))},a=0;a<t.length;a++)r(a);return n}}},55:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return b})),n.d(t,"i",(function(){return y})),n.d(t,"k",(function(){return T})),n.d(t,"g",(function(){return _})),n.d(t,"n",(function(){return j})),n.d(t,"l",(function(){return N})),n.d(t,"j",(function(){return I})),n.d(t,"h",(function(){return R})),n.d(t,"f",(function(){return w})),n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return k})),n.d(t,"m",(function(){return G}));var r=n(25),a=n(4),c=n.n(a),u=n(9),o=n(3),i=n(39),s=n.n(i),d=n(27),l=n(23),f=n(12),p=s.a.create();p.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status?(console.log(e.response.message),d.a.dispatch(Object(l.a)()),d.a.dispatch(Object(f.d)(f.a.authFailure))):500===e.response.status&&(console.log(e.response.message),d.a.dispatch(Object(f.d)(f.a.serverFailure))),Promise.reject(e.message)}));var g=p,O=n(61),E="/api/songs/",v=function(){return{headers:Object(O.a)()}},S={getAll:function(){var e=Object(u.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting songs..."),e.next=3,g.get(E,Object(o.a)(Object(o.a)({},v()),{},{params:t}));case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(u.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.get(E+t,v());case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(u.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Creating new song..."),e.next=3,g.post(E,t,v());case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),edit:function(){var e=Object(u.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.put(E+t.id,t,v());case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),destroy:function(){var e=Object(u.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Deleting song with id:",t),e.next=3,g.delete(E+t,v());case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},m=n(52),h=function(e){return function(){var t=Object(u.a)(c.a.mark((function t(n){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.create(e);case 3:return r=t.sent,n({type:"CREATE_SONG",data:r}),t.abrupt("return",r);case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},b=function(e,t){var n={title:e.title,sections:Object(r.a)(e.sections),username:t};return h(n)},y=function(e,t){var n=JSON.parse(JSON.stringify(e));return n.title=t,{type:"EDIT_SONG",data:n}},T=function(e){return function(){var t=Object(u.a)(c.a.mark((function t(n){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.getAll(e);case 3:r=t.sent,n({type:"INIT_SONGS",data:r}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},_=function(e){return function(){var t=Object(u.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.destroy(e.id);case 3:n({type:"DELETE_SONG",data:e}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},j=function(e){return{type:"SORT_SONGS",data:e}},N=function(e){return function(){var t=Object(u.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.edit(e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),n(Object(f.d)(f.a.validationFailure));case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}()},I=function(e){return{type:"EDIT_SONG",data:e}},R=function(e,t){return{type:"EDIT_SECTION",data:{songId:e,section:t}}},w=function(e,t){return{type:"DELETE_SECTION",data:{songId:e,section:t}}},L=function(e){var t=JSON.parse(JSON.stringify(e));return{type:"EDIT_SONG",data:t=m.a.addNewSection(t)}},k=function(e,t){return{type:"CLONE_SECTION",data:{songId:e,section:t}}},G=function(e,t){var n=JSON.parse(JSON.stringify(e));return n.sections=t,{type:"EDIT_SONG",data:n}};t.e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_SONGS":return t.data;case"CREATE_SONG":var n=e.concat(t.data);return n;case"EDIT_SONG":var r=t.data.id;return e.map((function(e){return e.id!==r?e:t.data}));case"SORT_SONGS":return t.data;case"DELETE_SONG":return e.filter((function(e){return e.id!==t.data.id}));case"EDIT_SECTION":var a=t.data.songId,c=t.data.section.id,u=e.find((function(e){return e.id===a})),i=u.sections.map((function(e){return e.id!==c?e:t.data.section}));return e.map((function(e){return e.id!==a?e:Object(o.a)(Object(o.a)({},u),{},{sections:i})}));case"DELETE_SECTION":var s=t.data.songId,d=t.data.section.id,l=e.find((function(e){return e.id===s})),f=l.sections.filter((function(e){return e.id!==d}));return e.map((function(e){return e.id!==s?e:Object(o.a)(Object(o.a)({},l),{},{sections:f})}));case"CLONE_SECTION":var p=t.data.songId,g=t.data.section.id,O=e.find((function(e){return e.id===p})),E=O.sections.find((function(e){return e.id===g})),v=m.a.cloneAndAddSection(O,E);return e.map((function(e){return e.id!==p?e:v}));default:return e}}},59:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i}));var r=n(3),a={editMode:!1,chords:!0,darkMode:!0},c=function(){return{type:"TOGGLE_EDIT_MODE"}},u=function(){return{type:"TOGGLE_CHORDS"}},o=function(){return{type:"RESET_SONG_STATUSES"}},i=function(){return{type:"TOGGLE_DARK_MODE"}};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_EDIT_MODE":return Object(r.a)(Object(r.a)({},e),{},{editMode:!e.editMode});case"TOGGLE_CHORDS":return Object(r.a)(Object(r.a)({},e),{},{chords:!e.chords});case"RESET_SONG_STATUSES":return Object(r.a)(Object(r.a)({},e),{},{editMode:a.editMode,chords:a.chords});case"TOGGLE_DARK_MODE":return Object(r.a)(Object(r.a)({},e),{},{darkMode:!e.darkMode});case"RESET_ALL_STATUSES":return a;default:return e}}},61:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=JSON.parse(localStorage.getItem("SongWriterUser"));return e&&e.token?{Authorization:"Bearer ".concat(e.token)}:{}}},62:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(25),a={SONG_TITLE_ERROR:"SONG_TITLE_ERROR",SECTION_NAME_ERROR:"SECTION_NAME_ERROR",SECTION_LINES_ERROR:"SECTION_LINES_ERROR"},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:"CREATE_ERROR",data:{type:e,id:t}}},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:"REMOVE_ERROR",data:{type:e,id:t}}};t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_ERROR":return[].concat(Object(r.a)(e),[t.data]);case"REMOVE_ERROR":return e.filter((function(e){return!(e.type===t.data.type&&e.id===t.data.id)}));default:return e}}},77:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r={},a=function(e){return{type:"SAVE_SNAPSHOT",data:e}},c=function(){return{type:"RESET_SNAPSHOT"}};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_SNAPSHOT":return t.data;case"RESET_SNAPSHOT":return r;default:return e}}},93:function(e,t,n){e.exports=n(140)},98:function(e,t,n){}},[[93,2,3]]]);
//# sourceMappingURL=main.89854028.chunk.js.map