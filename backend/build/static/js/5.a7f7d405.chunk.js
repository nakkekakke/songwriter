(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[5],{151:function(e,t,n){"use strict";var a=n(0),o=n.n(a),c=n(193),l=n(194),r=n(136),i=n(132),u=n(192),s=n(19),m=n(23),d=n(145),g=n(15),f=function(e){var t=e.loggedIn,n=Object(s.b)(),a=Object(d.k)();return o.a.createElement(u.a,{color:"inherit",onClick:function(){t&&(n(Object(m.e)()),n(Object(g.d)(g.a.logout))),a.push("/")}},t?"Log out":"Log in")},E=n(146),b=Object(i.a)((function(){return{navButton:{textDecoration:"none",color:"white",padding:20}}})),v=function(e){var t=e.path,n=e.text,a=e.onClick,c=b();return o.a.createElement(u.a,{component:E.Link,to:t,onClick:a,color:"inherit",className:c.navButton},n)},h=Object(i.a)((function(){return{root:{flex:1}}})),p=function(e){var t=e.loggedIn,n=h();return o.a.createElement("div",{className:n.root},t?o.a.createElement(v,{path:"/songs/",text:"Your songs"}):void 0)},j=Object(i.a)((function(){return{root:{flexGrow:1},title:{fontSize:20,paddingRight:15}}}));t.a=function(e){var t=e.loggedIn,n=j();return o.a.createElement("div",{className:n.root},o.a.createElement(c.a,{position:"static"},o.a.createElement(l.a,null,o.a.createElement(r.a,{className:n.title},"SongWriter"),o.a.createElement(p,{loggedIn:t}),o.a.createElement(f,{loggedIn:t}))))}},208:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(151),l=n(132),r=n(134),i=n(146),u=n(145),s=n(196),m=n(192),d=n(195),g=Object(l.a)((function(){return{item:{}}})),f=function(e){var t=e.song,n=g();return o.a.createElement(d.a,{component:i.Link,to:"/songs/".concat(t.id),divider:!0,className:n.item},o.a.createElement("h2",null,t.title))},E=n(19),b=n(197),v=n(45),h=n(47),p=Object(l.a)((function(){return{root:{},addSongButton:{margin:8}}})),j=function(){var e=p(),t=Object(E.c)((function(e){return e.songs})),n=Object(E.c)((function(e){return e.auth.user})),a=Object(E.b)(),c=Object(u.k)();console.log("Rendered",t.length,"songs");return o.a.createElement("div",{className:e.root},o.a.createElement("h1",null,"Songs"),o.a.createElement(s.a,null,0!==t.length?t.map((function(e){return o.a.createElement(f,{key:e.id,to:"/songs/".concat(e.id),song:e})})):o.a.createElement("p",null,"No songs found")),o.a.createElement(m.a,{className:e.addSongButton,variant:"contained",color:"primary",startIcon:o.a.createElement(b.a,null),onClick:function(){a(Object(h.c)(v.a.getDefaultSong(n))).then((function(e){c.push("/songs/"+e.id),console.log("Redirected!")})).catch((function(e){return console.log("Error creating new song:",e)}))}},"New song"))},O=n(148),C=n(206),k=n(211),S=n(201),y=n(202),N=n(203),B=n(204),w=n(205),x=n(63),D=n(64),I=n(5),L=n(207),M=n(198),T=n(161),W=n(199),A=Object(l.a)((function(e){return{section:{borderWidth:2,borderStyle:"solid",borderRadius:5,borderColor:e.palette.primary.main,padding:20,marginBottom:3,overflow:"auto",whiteSpace:"nowrap",backgroundColor:"#fff"},normalViewRoot:{marginTop:-12,marginBottom:-15},line:{marginTop:-5},editForm:{marginBottom:15},nameField:{marginBottom:10},bottomDiv:{display:"flex"},lineSubmitButton:{marginTop:10,marginBottom:-25},cloneButton:{marginTop:10,marginBottom:-25},deleteButton:{marginTop:10,marginBottom:-25,marginLeft:"auto"},dragHandle:{marginLeft:"auto",marginTop:10,marginBottom:-25}}})),F=function(e){var t=e.songId,n=e.sectionId,c=e.editMode,l=Object(a.useState)(!1),r=Object(O.a)(l,2),i=r[0],u=r[1],s=A(),d=Object(E.b)(),g=Object(T.c)((function(){return o.a.createElement(L.a,{className:s.dragHandle}," ",o.a.createElement(M.a,null,o.a.createElement(W.a,null))," ")})),f=Object(E.c)((function(e){return e.songs.find((function(e){return e.id===t})).sections.find((function(e){return e.id===n}))})),b=function(e){var n=Object(I.a)(Object(I.a)({},f),{},{lines:Object(D.a)(f.lines),name:e.target.value});d(Object(h.g)(t,n))},p=function(e){var n=v.a.linesStringToArray(e.target.value),a=Object(I.a)(Object(I.a)({},f),{},{lines:n});d(Object(h.g)(t,a))},j=function(){console.log("Cloning",f),d(Object(h.b)(t,f))},k=function(e){e.preventDefault(),console.log("Delete button pressed!"),i?(console.log("Delete for realz"),d(Object(h.e)(t,f))):u(!0)};return o.a.createElement("div",{className:s.section},c?o.a.createElement("form",{className:s.editForm},o.a.createElement(C.a,{className:s.nameField,label:"Edit name",name:"name",defaultValue:f.name,onChange:b}),o.a.createElement("div",null,o.a.createElement(C.a,{multiline:!0,label:"Lines",name:"lines",rows:f.lines.size,defaultValue:v.a.linesArrayToString(f.lines),onChange:p,fullWidth:!0})),o.a.createElement("div",{className:s.bottomDiv},o.a.createElement(m.a,{className:s.cloneButton,size:"small",color:"primary",variant:"outlined",onClick:j},"Clone"),o.a.createElement(g,null),o.a.createElement(m.a,{className:s.deleteButton,size:"small",color:"secondary",variant:"outlined",onClick:k},i?"Confirm deletion":"Delete"))):o.a.createElement("div",{className:s.normalViewRoot},o.a.createElement("h2",null,f.name),f.lines.map((function(e,t){return o.a.createElement("p",{className:s.line,key:t},e)}))))},R=n(171),z=n.n(R),V=Object(T.b)((function(e){var t=e.section,n=e.song,a=e.editMode;return o.a.createElement(F,{songId:n.id,sectionId:t.id,editMode:a})})),H=Object(T.a)((function(e){var t=e.song,n=e.editMode;return o.a.createElement(r.a,{maxWidth:!1,align:"left"},t.sections.map((function(e,a){return o.a.createElement(V,{key:e.id,index:a,section:e,song:t,editMode:n})})))})),J=function(e){var t=e.song,n=e.editMode,a=Object(E.b)(),c=function(e){var n=e.oldIndex,o=e.newIndex,c=z()(t.sections,n,o);a(Object(h.l)(t,c))};return 0===t.sections.length?o.a.createElement(r.a,null,o.a.createElement("h2",null,"No sections")):o.a.createElement(H,{song:t,editMode:n,onSortEnd:c,useDragHandle:!0,useWindowAsScrollContainer:!0})},Y=n(177),q=n.n(Y),G=n(179),K=n.n(G),P=n(140),Q=n(200),U=Object(l.a)((function(e){return{root:{},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})),X=function(e){var t=e.onClick,n=U();return o.a.createElement(P.a,{className:n.closeButton,onClick:t},o.a.createElement(Q.a,null))},Z=function(e){var t=e.handleSaveAgreeClick,n=e.handleSaveDiscardClick,a=e.unsavedChanges,c=function(e){return function(){t(),e()}},l=function(e){return function(){n(),e()}};return o.a.createElement(K.a,{when:a()},(function(e){return function(e,t,n){return o.a.createElement(k.a,{open:e,onClose:t},o.a.createElement(S.a,null,"You have unsaved changes"),o.a.createElement(y.a,null,o.a.createElement(N.a,null,"If you leave without saving, all changes will be lost!")),o.a.createElement(B.a,null,o.a.createElement(m.a,{onClick:c(n),color:"primary",variant:"contained"},"Save and leave"),o.a.createElement(m.a,{onClick:l(n),color:"secondary",variant:"contained"},"Leave without saving"),o.a.createElement(X,{onClick:t})))}(e.isActive,e.onCancel,e.onConfirm)}))},$=Object(l.a)((function(e){return{root:{},menuContainer:{marginBottom:e.spacing(1)},editModeButton:{marginLeft:e.spacing(1)},titleField:{margin:15},addSectionButton:{marginTop:e.spacing(1)},deleteSongButton:{marginLeft:"auto"},dialogCloseButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})),_=function(){var e=Object(a.useState)(!1),t=Object(O.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(!1),i=Object(O.a)(l,2),s=i[0],d=i[1],g=Object(a.useState)(!1),f=Object(O.a)(g,2),v=f[0],p=f[1],j=Object(a.useState)(!1),D=Object(O.a)(j,2),I=D[0],L=D[1],M=$(),T=Object(u.m)().id,W=Object(E.b)(),A=Object(u.k)(),F=Object(E.c)((function(e){return e.songs.find((function(e){return e.id===T}))})),R=Object(E.c)((function(e){return e.snapshot}));console.log("Song render:",F);var z=function(){W(Object(x.c)(F)),W(Object(h.k)(F))},V=function(){n?Y():H()},H=function(){W(Object(x.c)(F)),c(!0)},Y=function(){console.log("Exiting edit mode"),_()?p(!0):(c(!1),W(Object(x.b)()))},G=function(){console.log("Saving!"),p(!1),c(!1),W(Object(x.b)()),W(Object(h.k)(F))},K=function(){console.log("Discarding changes!"),p(!1),c(!1),W(Object(x.b)()),W(Object(h.i)(R)),console.log("Snapshot after reset:",R)},P=function(e){""===e.target.value?L(!0):I&&L(!1),W(Object(h.h)(F,e.target.value))},Q=function(){console.log("Add new section!"),W(Object(h.a)(F))},U=function(){console.log("Deleting song here"),W(Object(h.f)(F)),W(Object(x.b)()),A.push("/songs/")},_=function(){return!q.a.isEmpty(R)&&!q.a.isEqual(R,F)};return F?o.a.createElement("div",{className:M.root},n?o.a.createElement(C.a,{error:I,className:M.titleField,label:"Edit title",defaultValue:F.title,onChange:P,helperText:I?"Title cannot be empty!":""}):o.a.createElement("h1",null,F.title),o.a.createElement("div",null,o.a.createElement(r.a,{align:"right",maxWidth:!1,className:M.menuContainer},function(){if(_())return o.a.createElement(m.a,{color:"primary",variant:"outlined",onClick:z},"Save changes")}(),o.a.createElement(m.a,{color:"primary",variant:"contained",onClick:V,className:M.editModeButton},n?"Exit edit mode":"Edit mode")),o.a.createElement(J,{song:F,editMode:n})),o.a.createElement(r.a,{maxWidth:!1},n?o.a.createElement(m.a,{className:M.addSectionButton,variant:"contained",color:"primary",startIcon:o.a.createElement(b.a,null),onClick:Q},"New section"):o.a.createElement("div",null)),o.a.createElement(r.a,{align:"right",maxWidth:!1},n?o.a.createElement(m.a,{className:M.deleteSongButton,variant:"contained",color:"secondary",startIcon:o.a.createElement(w.a,null),onClick:function(){return d(!0)}},"Delete song"):o.a.createElement("div",null)),o.a.createElement(k.a,{open:s,onClose:function(){return d(!1)}},o.a.createElement(S.a,null,"Delete this song?"),o.a.createElement(y.a,null,o.a.createElement(N.a,null,"Once deleted, this song cannot be restored (not even by discarding changes when exiting Edit Mode).")),o.a.createElement(B.a,null,o.a.createElement(m.a,{onClick:U,color:"secondary",variant:"contained"},"Delete permanently"),o.a.createElement(m.a,{onClick:function(){return d(!1)},variant:"contained"},"Cancel"))),o.a.createElement(k.a,{open:v,onClose:function(){return p(!1)}},o.a.createElement(S.a,null,"Save changes?"),o.a.createElement(y.a,null,o.a.createElement(N.a,null,"Save or discard the changes you have made.")),o.a.createElement(B.a,null,o.a.createElement(m.a,{onClick:G,color:"primary",variant:"contained"},"Save changes"),o.a.createElement(m.a,{onClick:K,color:"secondary",variant:"contained"},"Discard changes"),o.a.createElement(X,{onClick:function(){return p(!1)}}))),o.a.createElement(Z,{handleSaveAgreeClick:G,handleSaveDiscardClick:K,unsavedChanges:_})):o.a.createElement("div",null,o.a.createElement("h1",null,"Loading"),o.a.createElement("p",null,"Check the url if it takes too long"))},ee=Object(l.a)((function(){return{mainContainer:{justifyContent:"center",alignItems:"center",padding:20},contentContainer:{}}}));t.default=function(){console.log("App rendering");var e=ee(),t=Object(E.b)(),n=Object(E.c)((function(e){return e.auth.user}));return Object(a.useEffect)((function(){console.log("App effect"),t(Object(h.j)(n))}),[t,n]),o.a.createElement(o.a.Fragment,null,o.a.createElement(i.BrowserRouter,null,o.a.createElement(c.a,{loggedIn:!0}),o.a.createElement(r.a,{maxWidth:!1,className:e.mainContainer},o.a.createElement(r.a,{maxWidth:!1,align:"center",className:e.contentContainer},o.a.createElement(u.g,null,o.a.createElement(u.d,{path:"/songs/:id"},o.a.createElement(_,null)),o.a.createElement(u.d,{path:"/songs/"},o.a.createElement(j,null)),o.a.createElement(u.d,{path:"/"},o.a.createElement("p",null,"Welcome")))))))}}}]);
//# sourceMappingURL=5.a7f7d405.chunk.js.map