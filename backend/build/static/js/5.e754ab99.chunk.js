(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[5],{148:function(e,t,n){"use strict";var a=n(0),o=n.n(a),c=n(132),l=n(136),r=Object(c.a)((function(){return{header:{marginTop:30}}}));t.a=function(e){var t=e.text,n=r();return o.a.createElement(l.a,{component:"h1",variant:"h4",className:n.header},t)}},152:function(e,t,n){"use strict";var a=n(0),o=n.n(a),c=n(197),l=n(198),r=n(136),i=n(132),u=n(196),s=n(19),m=n(23),d=n(145),g=n(15),f=function(e){var t=e.loggedIn,n=Object(s.b)(),a=Object(d.k)();return o.a.createElement(u.a,{color:"inherit",onClick:function(){t&&(n(Object(m.e)()),n(Object(g.d)(g.a.logout))),a.push("/")}},t?"Log out":"Log in")},E=n(146),b=Object(i.a)((function(){return{navButton:{textDecoration:"none",color:"white",padding:20}}})),v=function(e){var t=e.path,n=e.text,a=e.onClick,c=b();return o.a.createElement(u.a,{component:E.Link,to:t,onClick:a,color:"inherit",className:c.navButton},n)},p=Object(i.a)((function(){return{root:{flex:1}}})),h=function(e){var t=e.loggedIn,n=p();return o.a.createElement("div",{className:n.root},t?o.a.createElement(v,{path:"/songs/",text:"Your songs"}):void 0)},O=Object(i.a)((function(){return{root:{flexGrow:1},title:{fontSize:20,paddingRight:15}}}));t.a=function(e){var t=e.loggedIn,n=O();return o.a.createElement("div",{className:n.root},o.a.createElement(c.a,{position:"static"},o.a.createElement(l.a,null,o.a.createElement(r.a,{className:n.title},"SongWriter"),o.a.createElement(h,{loggedIn:t}),o.a.createElement(f,{loggedIn:t}))))}},214:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(152),l=n(132),r=n(134),i=n(146),u=n(145),s=n(204),m=n(196),d=n(206),g=n(136),f=n(149),E=n(140),b=n(182),v=n(205),p=n(203),h=n(19),O=n(48),j=n(217),C=n(199),k=n(200),N=n(201),S=n(202),y=function(e){var t=e.open,n=e.setOpen,a=e.handleConfirmClick;return o.a.createElement(j.a,{open:t,onClose:function(){return n(!1)}},o.a.createElement(C.a,null,"Delete this song?"),o.a.createElement(k.a,null,o.a.createElement(N.a,null,"Once deleted, this song cannot be restored.")),o.a.createElement(S.a,null,o.a.createElement(m.a,{onClick:a,color:"secondary",variant:"contained"},"Delete permanently"),o.a.createElement(m.a,{onClick:function(){return n(!1)},variant:"contained"},"Cancel")))},B=Object(l.a)((function(){return{menu:{"& .MuiPaper-root":{}}}})),x=function(e){var t=e.song,n=Object(a.useState)(null),c=Object(f.a)(n,2),l=c[0],r=c[1],i=Object(a.useState)(!1),u=Object(f.a)(i,2),s=u[0],d=u[1],g=B(),j=Object(h.b)(),C=Object(h.c)((function(e){return e.auth.user})),k=function(){r(null)};return o.a.createElement(o.a.Fragment,null,o.a.createElement(E.a,{onClick:function(e){r(e.target)}},o.a.createElement(p.a,null)),o.a.createElement(b.a,{elevation:1,anchorEl:l,keepMounted:!0,open:null!==l,onClose:k,className:g.menu},o.a.createElement(v.a,null,o.a.createElement(m.a,{variant:"outlined",color:"primary",onClick:function(){j(Object(O.c)(t,C.username)),k()}},"Clone")),o.a.createElement(v.a,null,o.a.createElement(m.a,{variant:"outlined",color:"secondary",onClick:function(){d(!0),k()}},"Delete"))),o.a.createElement(y,{open:s,setOpen:d,handleConfirmClick:function(){j(Object(O.g)(t))}}))},w=Object(l.a)((function(){return{item:{},container:{display:"flex",justifyContent:"space-between"},title:{textAlign:"left",marginTop:8,marginBottom:8},menu:{}}})),D=function(e){var t=e.song,n=w();return o.a.createElement(r.a,{maxWidth:"xl",className:n.container},o.a.createElement(d.a,{component:i.Link,to:"/songs/".concat(t.id),divider:!0,className:n.item},o.a.createElement(g.a,{variant:"h6",className:n.title},t.title)),o.a.createElement(x,{song:t,className:n.menu}))},I=n(207),T=n(46),M=n(148),W=Object(l.a)((function(){return{list:{marginTop:10},addSongButton:{margin:8}}})),L=function(){var e=W(),t=Object(h.c)((function(e){return e.songs})),n=Object(h.c)((function(e){return e.auth.user})),a=Object(h.b)(),c=Object(u.k)();console.log("Rendered",t.length,"songs");return o.a.createElement("div",null,o.a.createElement(M.a,{text:"Your songs"}),o.a.createElement(s.a,{className:e.list},0!==t.length?t.map((function(e){return o.a.createElement(D,{key:e.id,to:"/songs/".concat(e.id),song:e})})):o.a.createElement("p",null,"No songs found")),o.a.createElement(m.a,{className:e.addSongButton,variant:"contained",color:"primary",startIcon:o.a.createElement(I.a,null),onClick:function(){a(Object(O.d)(T.a.getDefaultSong(n))).then((function(e){c.push("/songs/"+e.id),console.log("Redirected!")})).catch((function(e){return console.log("Error creating new song:",e)}))}},"New song"))},A=n(212),F=n(211),R=n(64),z=n(41),V=n(5),H=n(213),Y=n(208),J=n(163),q=n(209),G=Object(l.a)((function(e){return{section:{borderWidth:2,borderStyle:"solid",borderRadius:5,borderColor:e.palette.primary.main,padding:20,marginBottom:3,overflow:"auto",whiteSpace:"nowrap",backgroundColor:"#fff"},normalViewRoot:{marginTop:-12,marginBottom:-15},name:{marginTop:10},linesDiv:{marginTop:12,marginBottom:10},line:{marginBottom:5},editForm:{marginBottom:15},nameField:{marginBottom:10},bottomDiv:{display:"flex"},lineSubmitButton:{marginTop:10,marginBottom:-25},cloneButton:{marginTop:10,marginBottom:-25},deleteButton:{marginTop:10,marginBottom:-25,marginLeft:"auto"},dragHandle:{marginLeft:"auto",marginTop:10,marginBottom:-25}}})),P=function(e){var t=e.songId,n=e.sectionId,c=e.editMode,l=Object(a.useState)(!1),r=Object(f.a)(l,2),i=r[0],u=r[1],s=G(),d=Object(h.b)(),E=Object(J.c)((function(){return o.a.createElement(H.a,{className:s.dragHandle}," ",o.a.createElement(Y.a,null,o.a.createElement(q.a,null))," ")})),b=Object(h.c)((function(e){return e.songs.find((function(e){return e.id===t})).sections.find((function(e){return e.id===n}))})),v=function(e){var n=Object(V.a)(Object(V.a)({},b),{},{lines:Object(z.a)(b.lines),name:e.target.value});d(Object(O.h)(t,n))},p=function(e){var n=T.a.linesStringToArray(e.target.value),a=Object(V.a)(Object(V.a)({},b),{},{lines:n});d(Object(O.h)(t,a))},j=function(){console.log("Cloning",b),d(Object(O.b)(t,b))},C=function(e){e.preventDefault(),console.log("Delete button pressed!"),i?(console.log("Delete for realz"),d(Object(O.f)(t,b))):u(!0)};return o.a.createElement("div",{className:s.section},c?o.a.createElement("form",{className:s.editForm},o.a.createElement(A.a,{className:s.nameField,label:"Edit name",name:"name",defaultValue:b.name,onChange:v}),o.a.createElement("div",null,o.a.createElement(A.a,{multiline:!0,label:"Lines",name:"lines",rows:b.lines.size,defaultValue:T.a.linesArrayToString(b.lines),onChange:p,fullWidth:!0})),o.a.createElement("div",{className:s.bottomDiv},o.a.createElement(m.a,{className:s.cloneButton,size:"small",color:"primary",variant:"outlined",onClick:j},"Clone"),o.a.createElement(E,null),o.a.createElement(m.a,{className:s.deleteButton,size:"small",color:"secondary",variant:"outlined",onClick:C},i?"Confirm deletion":"Delete"))):o.a.createElement("div",{className:s.normalViewRoot},o.a.createElement(g.a,{variant:"h6",className:s.name},b.name),o.a.createElement("div",{className:s.linesDiv},b.lines.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement(g.a,{variant:"body1",className:s.line},e))})))))},K=n(173),Q=n.n(K),U=Object(J.b)((function(e){var t=e.section,n=e.song,a=e.editMode;return o.a.createElement(P,{songId:n.id,sectionId:t.id,editMode:a})})),X=Object(J.a)((function(e){var t=e.song,n=e.editMode;return o.a.createElement(r.a,{maxWidth:!1,align:"left"},t.sections.map((function(e,a){return o.a.createElement(U,{key:e.id,index:a,section:e,song:t,editMode:n})})))})),Z=function(e){var t=e.song,n=e.editMode,a=Object(h.b)(),c=function(e){var n=e.oldIndex,o=e.newIndex,c=Q()(t.sections,n,o);a(Object(O.m)(t,c))};return 0===t.sections.length?o.a.createElement(r.a,null,o.a.createElement("h2",null,"No sections")):o.a.createElement(X,{song:t,editMode:n,onSortEnd:c,useDragHandle:!0,useWindowAsScrollContainer:!0})},$=n(179),_=n.n($),ee=n(181),te=n.n(ee),ne=n(210),ae=Object(l.a)((function(e){return{root:{},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})),oe=function(e){var t=e.onClick,n=ae();return o.a.createElement(E.a,{className:n.closeButton,onClick:t},o.a.createElement(ne.a,null))},ce=function(e){var t=e.handleSaveConfirmClick,n=e.handleSaveDiscardClick,a=e.unsavedChanges,c=function(e){return function(){t(),e()}},l=function(e){return function(){n(),e()}};return o.a.createElement(te.a,{when:a()},(function(e){return function(e,t,n){return o.a.createElement(j.a,{open:e,onClose:t},o.a.createElement(C.a,null,"You have unsaved changes"),o.a.createElement(k.a,null,o.a.createElement(N.a,null,"If you leave without saving, all changes will be lost!")),o.a.createElement(S.a,null,o.a.createElement(m.a,{onClick:c(n),color:"primary",variant:"contained"},"Save and leave"),o.a.createElement(m.a,{onClick:l(n),color:"secondary",variant:"contained"},"Leave without saving"),o.a.createElement(oe,{onClick:t})))}(e.isActive,e.onCancel,e.onConfirm)}))},le=function(e){var t=e.open,n=e.setOpen,a=e.handleConfirmClick,c=e.handleDiscardClick;return o.a.createElement(j.a,{open:t,onClose:function(){return n(!1)}},o.a.createElement(C.a,null,"Save changes?"),o.a.createElement(k.a,null,o.a.createElement(N.a,null,"Save or discard the changes you have made.")),o.a.createElement(S.a,null,o.a.createElement(m.a,{onClick:a,color:"primary",variant:"contained"},"Save changes"),o.a.createElement(m.a,{onClick:c,color:"secondary",variant:"contained"},"Discard changes"),o.a.createElement(oe,{onClick:function(){return n(!1)}})))},re=Object(l.a)((function(e){return{root:{},menuContainer:{marginBottom:e.spacing(1)},editModeButton:{marginLeft:e.spacing(1)},titleField:{margin:12},addSectionButton:{marginTop:e.spacing(1)},deleteSongButton:{marginLeft:"auto"},dialogCloseButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})),ie=function(){var e=Object(a.useState)(!1),t=Object(f.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(!1),i=Object(f.a)(l,2),s=i[0],d=i[1],g=Object(a.useState)(!1),E=Object(f.a)(g,2),b=E[0],v=E[1],p=Object(a.useState)(!1),j=Object(f.a)(p,2),C=j[0],k=j[1],N=re(),S=Object(u.m)().id,B=Object(h.b)(),x=Object(u.k)(),w=Object(h.c)((function(e){return e.songs.find((function(e){return e.id===S}))})),D=Object(h.c)((function(e){return e.snapshot}));Object(a.useEffect)((function(){B(Object(R.b)())}),[B]),console.log("Song render:",w);var T=function(){B(Object(R.c)(w)),B(Object(O.l)(w))},W=function(){n?z():L()},L=function(){B(Object(R.c)(w)),c(!0)},z=function(){console.log("Exiting edit mode"),q()?v(!0):(c(!1),B(Object(R.b)()))},V=function(){console.log("Saving!"),v(!1),c(!1),B(Object(R.b)()),B(Object(O.l)(w))},H=function(){console.log("Discarding changes!"),v(!1),c(!1),B(Object(O.j)(D)),B(Object(R.b)())},Y=function(e){""===e.target.value?k(!0):C&&k(!1),B(Object(O.i)(w,e.target.value))},J=function(){console.log("Add new section!"),B(Object(O.a)(w))},q=function(){return!_.a.isEmpty(D)&&!_.a.isEqual(D,w)};return w?o.a.createElement("div",{className:N.root},n?o.a.createElement(A.a,{error:C,className:N.titleField,label:"Edit title",defaultValue:w.title,onChange:Y,helperText:C?"Title cannot be empty!":""}):o.a.createElement(M.a,{text:w.title}),o.a.createElement("div",null,o.a.createElement(r.a,{align:"right",maxWidth:!1,className:N.menuContainer},function(){if(q())return o.a.createElement(m.a,{color:"primary",variant:"outlined",onClick:T},"Save changes")}(),o.a.createElement(m.a,{color:"primary",variant:"contained",onClick:W,className:N.editModeButton},n?"Exit edit mode":"Edit mode")),o.a.createElement(Z,{song:w,editMode:n})),o.a.createElement(r.a,{maxWidth:!1},n?o.a.createElement(m.a,{className:N.addSectionButton,variant:"contained",color:"primary",startIcon:o.a.createElement(I.a,null),onClick:J},"New section"):o.a.createElement("div",null)),o.a.createElement(r.a,{align:"right",maxWidth:!1},n?o.a.createElement(m.a,{className:N.deleteSongButton,variant:"contained",color:"secondary",startIcon:o.a.createElement(F.a,null),onClick:function(){return d(!0)}},"Delete song"):o.a.createElement("div",null)),o.a.createElement(y,{open:s,setOpen:d,handleConfirmClick:function(){console.log("Deleting song here"),B(Object(O.g)(w)),B(Object(R.b)()),x.push("/songs/")}}),o.a.createElement(le,{open:b,setOpen:v,handleConfirmClick:V,handleDiscardClick:H}),o.a.createElement(ce,{handleSaveConfirmClick:V,handleSaveDiscardClick:H,unsavedChanges:q})):o.a.createElement("div",null,o.a.createElement(M.a,{text:"Loading song"}),o.a.createElement("p",null,"Check the url if it takes too long"))},ue=Object(l.a)((function(){return{mainContainer:{justifyContent:"center",alignItems:"center",padding:20},contentContainer:{}}}));t.default=function(){console.log("App rendering");var e=ue(),t=Object(h.b)(),n=Object(h.c)((function(e){return e.auth.user}));return Object(a.useEffect)((function(){console.log("App effect"),t(Object(O.k)(n))}),[t,n]),o.a.createElement(o.a.Fragment,null,o.a.createElement(i.BrowserRouter,null,o.a.createElement(c.a,{loggedIn:!0}),o.a.createElement(r.a,{maxWidth:!1,className:e.mainContainer},o.a.createElement(r.a,{maxWidth:!1,align:"center",className:e.contentContainer},o.a.createElement(u.g,null,o.a.createElement(u.d,{path:"/songs/:id"},o.a.createElement(ie,null)),o.a.createElement(u.d,{path:"/songs/"},o.a.createElement(L,null)),o.a.createElement(u.d,{path:"/"},o.a.createElement("p",null,"Welcome")))))))}}}]);
//# sourceMappingURL=5.e754ab99.chunk.js.map