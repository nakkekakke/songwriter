(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[5],{149:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(133),c=n(137),l=Object(r.a)((function(){return{header:{marginTop:30}}}));t.a=function(e){var t=e.text,n=l();return o.a.createElement(c.a,{component:"h1",variant:"h4",className:n.header},t)}},153:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(201),c=n(202),l=n(137),i=n(133),s=n(200),u=n(19),m=n(23),d=n(146),g=n(13),E=function(e){var t=e.loggedIn,n=Object(u.b)(),a=Object(d.k)();return o.a.createElement(s.a,{color:"inherit",onClick:function(){t&&(n(Object(m.e)()),n(Object(g.d)(g.a.logout))),a.push("/")}},t?"Log out":"Log in")},f=n(147),b=Object(i.a)((function(){return{navButton:{textDecoration:"none",color:"white",padding:20}}})),v=function(e){var t=e.path,n=e.text,a=e.onClick,r=b();return o.a.createElement(s.a,{component:f.Link,to:t,onClick:a,color:"inherit",className:r.navButton},n)},O=Object(i.a)((function(){return{root:{flex:1}}})),p=function(e){var t=e.loggedIn,n=O();return o.a.createElement("div",{className:n.root},t?o.a.createElement(v,{path:"/songs/",text:"Your songs"}):void 0)},h=Object(i.a)((function(){return{root:{flexGrow:1},title:{fontSize:20,paddingRight:15}}}));t.a=function(e){var t=e.loggedIn,n=h();return o.a.createElement("div",{className:n.root},o.a.createElement(r.a,{position:"static"},o.a.createElement(c.a,null,o.a.createElement(l.a,{className:n.title},"SongWriter"),o.a.createElement(p,{loggedIn:t}),o.a.createElement(E,{loggedIn:t}))))}},219:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(153),c=n(133),l=n(135),i=n(147),s=n(146),u=n(209),m=n(200),d=n(211),g=n(137),E=n(150),f=n(141),b=n(186),v=n(210),O=n(208),p=n(19),h=n(48),j=n(222),C=n(204),k=n(205),N=n(206),S=n(207),y=function(e){var t=e.open,n=e.setOpen,a=e.handleConfirmClick;return o.a.createElement(j.a,{open:t,onClose:function(){return n(!1)}},o.a.createElement(C.a,null,"Delete this song?"),o.a.createElement(k.a,null,o.a.createElement(N.a,null,"Once deleted, this song cannot be restored.")),o.a.createElement(S.a,null,o.a.createElement(m.a,{onClick:a,color:"secondary",variant:"contained"},"Delete permanently"),o.a.createElement(m.a,{onClick:function(){return n(!1)},variant:"contained"},"Cancel")))},R=Object(c.a)((function(){return{menu:{"& .MuiPaper-root":{}}}})),B=function(e){var t=e.song,n=Object(a.useState)(null),r=Object(E.a)(n,2),c=r[0],l=r[1],i=Object(a.useState)(!1),s=Object(E.a)(i,2),u=s[0],d=s[1],g=R(),j=Object(p.b)(),C=Object(p.c)((function(e){return e.auth.user})),k=function(){l(null)};return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a,{onClick:function(e){l(e.target)}},o.a.createElement(O.a,null)),o.a.createElement(b.a,{elevation:1,anchorEl:c,keepMounted:!0,open:null!==c,onClose:k,className:g.menu},o.a.createElement(v.a,null,o.a.createElement(m.a,{variant:"outlined",color:"primary",onClick:function(){j(Object(h.c)(t,C.username)),k()}},"Clone")),o.a.createElement(v.a,null,o.a.createElement(m.a,{variant:"outlined",color:"secondary",onClick:function(){d(!0),k()}},"Delete"))),o.a.createElement(y,{open:u,setOpen:d,handleConfirmClick:function(){j(Object(h.g)(t))}}))},w=Object(c.a)((function(){return{item:{},container:{display:"flex",justifyContent:"space-between"},title:{textAlign:"left",marginTop:8,marginBottom:8},menu:{}}})),x=function(e){var t=e.song,n=w();return o.a.createElement(l.a,{maxWidth:"xl",className:n.container},o.a.createElement(d.a,{component:i.Link,to:"/songs/".concat(t.id),divider:!0,className:n.item},o.a.createElement(g.a,{variant:"h6",className:n.title},t.title)),o.a.createElement(B,{song:t,className:n.menu}))},I=n(212),T=n(46),D=n(149),L=Object(c.a)((function(){return{list:{marginTop:10},addSongButton:{margin:8}}})),_=function(){var e=L(),t=Object(p.c)((function(e){return e.songs})),n=Object(p.c)((function(e){return e.auth.user})),a=Object(p.b)(),r=Object(s.k)();console.log("Rendered",t.length,"songs");return o.a.createElement("div",null,o.a.createElement(D.a,{text:"Your songs"}),o.a.createElement(u.a,{className:e.list},0!==t.length?t.map((function(e){return o.a.createElement(x,{key:e.id,to:"/songs/".concat(e.id),song:e})})):o.a.createElement("p",null,"No songs found")),o.a.createElement(m.a,{className:e.addSongButton,variant:"contained",color:"primary",startIcon:o.a.createElement(I.a,null),onClick:function(){a(Object(h.d)(T.a.getDefaultSong(n))).then((function(e){r.push("/songs/"+e.id),console.log("Redirected!")})).catch((function(e){return console.log("Error creating new song:",e)}))}},"New song"))},M=n(217),A=n(216),W=n(65),F=n(25),z=n(5),V=n(218),G=n(213),H=n(165),Y=n(214),J=n(52),q=Object(c.a)((function(e){return{section:{borderWidth:2,borderStyle:"solid",borderRadius:5,borderColor:e.palette.primary.main,padding:20,marginBottom:3,overflow:"auto",whiteSpace:"nowrap",backgroundColor:"#fff"},normalViewRoot:{marginTop:-12,marginBottom:-15},name:{marginTop:10},linesDiv:{marginTop:12,marginBottom:10},line:{marginBottom:5},editForm:{marginBottom:15},nameField:{marginBottom:10},bottomDiv:{display:"flex"},lineSubmitButton:{marginTop:10,marginBottom:-25},cloneButton:{marginTop:10,marginBottom:-25},deleteButton:{marginTop:10,marginBottom:-25,marginLeft:"auto"},dragHandle:{marginLeft:"auto",marginTop:10,marginBottom:-25}}})),P=function(e){var t=e.songId,n=e.sectionId,r=e.editMode,c=Object(a.useState)(!1),l=Object(E.a)(c,2),i=l[0],s=l[1],u=q(),d=Object(p.b)(),f=Object(H.c)((function(){return o.a.createElement(V.a,{className:u.dragHandle}," ",o.a.createElement(G.a,null,o.a.createElement(Y.a,null))," ")})),b=Object(p.c)((function(e){return e.songs.find((function(e){return e.id===t})).sections.find((function(e){return e.id===n}))})),v=Object(p.c)((function(e){return e.errors.find((function(e){return e.type===J.c.SECTION_NAME_ERROR&&e.id===n}))})),O=Object(p.c)((function(e){return e.errors.find((function(e){return e.type===J.c.SECTION_LINES_ERROR&&e.id===n}))})),j=function(e){var a=e.target.value,o=Object(z.a)(Object(z.a)({},b),{},{lines:Object(F.a)(b.lines),name:a});0===a.length||a.length>50?d(Object(J.a)(J.c.SECTION_NAME_ERROR,n)):d(Object(J.d)(J.c.SECTION_NAME_ERROR,n)),d(Object(h.h)(t,o))},C=function(e){var a=T.a.linesStringToArray(e.target.value),o=Object(z.a)(Object(z.a)({},b),{},{lines:a});T.a.validateLines(a)?d(Object(J.d)(J.c.SECTION_LINES_ERROR,n)):d(Object(J.a)(J.c.SECTION_LINES_ERROR,n)),d(Object(h.h)(t,o))},k=function(){console.log("Cloning",b),d(Object(h.b)(t,b))},N=function(e){e.preventDefault(),console.log("Delete button pressed!"),i?(console.log("Delete for realz"),d(Object(h.f)(t,b))):s(!0)};return o.a.createElement("div",{className:u.section},r?o.a.createElement("form",{className:u.editForm},o.a.createElement(M.a,{className:u.nameField,error:void 0!==v,label:"Edit name",name:"name",defaultValue:b.name,onChange:j,helperText:v?"Length must be 1-50 characters":""}),o.a.createElement("div",null,o.a.createElement(M.a,{multiline:!0,error:void 0!==O,label:"Lines",name:"lines",rows:b.lines.size,defaultValue:T.a.linesArrayToString(b.lines),onChange:C,fullWidth:!0,helperText:O?"Max 200 characters for one line":""})),o.a.createElement("div",{className:u.bottomDiv},o.a.createElement(m.a,{className:u.cloneButton,size:"small",color:"primary",variant:"outlined",onClick:k},"Clone"),o.a.createElement(f,null),o.a.createElement(m.a,{className:u.deleteButton,size:"small",color:"secondary",variant:"outlined",onClick:N},i?"Confirm deletion":"Delete"))):o.a.createElement("div",{className:u.normalViewRoot},o.a.createElement(g.a,{variant:"h6",className:u.name},b.name),o.a.createElement("div",{className:u.linesDiv},b.lines.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement(g.a,{variant:"body1",className:u.line},e))})))))},K=n(176),Q=n.n(K),U=Object(H.b)((function(e){var t=e.section,n=e.song,a=e.editMode;return o.a.createElement(P,{songId:n.id,sectionId:t.id,editMode:a})})),X=Object(H.a)((function(e){var t=e.song,n=e.editMode;return o.a.createElement(l.a,{maxWidth:!1,align:"left"},t.sections.map((function(e,a){return o.a.createElement(U,{key:e.id,index:a,section:e,song:t,editMode:n})})))})),Z=function(e){var t=e.song,n=e.editMode,a=Object(p.b)(),r=function(e){var n=e.oldIndex,o=e.newIndex,r=Q()(t.sections,n,o);a(Object(h.m)(t,r))};return 0===t.sections.length?o.a.createElement(l.a,null,o.a.createElement("h2",null,"No sections")):o.a.createElement(X,{song:t,editMode:n,onSortEnd:r,useDragHandle:!0,useWindowAsScrollContainer:!0})},$=n(182),ee=n.n($),te=n(223),ne=n(184),ae=n.n(ne),oe=n(215),re=Object(c.a)((function(e){return{root:{},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})),ce=function(e){var t=e.onClick,n=re();return o.a.createElement(f.a,{className:n.closeButton,onClick:t},o.a.createElement(oe.a,null))},le=function(e){var t=e.handleSaveConfirmClick,n=e.handleSaveDiscardClick,a=e.unsavedChanges,r=e.saveAllowed,c=void 0===r||r,l=function(e){return o.a.createElement(m.a,{onClick:s(e),color:"primary",variant:"contained"},"Save and leave")},i=function(e){return o.a.createElement(te.a,{title:"Resolve errors before saving",arrow:!0},o.a.createElement("span",null," ",o.a.createElement(m.a,{onClick:s(e),color:"primary",variant:"contained",disabled:!0},"Can't save")))},s=function(e){return function(){t(),e()}},u=function(e){return function(){n(),e()}};return o.a.createElement(ae.a,{when:a()},(function(e){return function(e,t,n){return o.a.createElement(j.a,{open:e,onClose:t},o.a.createElement(C.a,null,"You have unsaved changes"),o.a.createElement(k.a,null,o.a.createElement(N.a,null,"If you leave without saving, all changes will be lost!")),o.a.createElement(S.a,null,c?l(n):i(n),o.a.createElement(m.a,{onClick:u(n),color:"secondary",variant:"contained"},"Leave without saving"),o.a.createElement(ce,{onClick:t})))}(e.isActive,e.onCancel,e.onConfirm)}))},ie=function(e){var t=e.open,n=e.setOpen,a=e.handleConfirmClick,r=e.handleDiscardClick,c=e.saveAllowed,l=void 0===c||c;return o.a.createElement(j.a,{open:t,onClose:function(){return n(!1)}},o.a.createElement(C.a,null,"Save changes?"),o.a.createElement(k.a,null,o.a.createElement(N.a,null,"Save or discard the changes you have made.")),o.a.createElement(S.a,null,l?o.a.createElement(m.a,{onClick:a,color:"primary",variant:"contained"},"Save changes"):o.a.createElement(te.a,{title:"Resolve errors before saving",arrow:!0},o.a.createElement("span",null," ",o.a.createElement(m.a,{onClick:a,color:"primary",variant:"contained",disabled:!0},"Can't save"))),o.a.createElement(m.a,{onClick:r,color:"secondary",variant:"contained"},"Discard changes"),o.a.createElement(ce,{onClick:function(){return n(!1)}})))},se=Object(c.a)((function(e){return{root:{},menuContainer:{marginBottom:e.spacing(1)},editModeButton:{marginLeft:e.spacing(1)},titleField:{margin:12},addSectionButton:{marginTop:e.spacing(1)},deleteSongButton:{marginLeft:"auto"},dialogCloseButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})),ue=function(){var e=Object(a.useState)(!1),t=Object(E.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),i=Object(E.a)(c,2),u=i[0],d=i[1],g=Object(a.useState)(!1),f=Object(E.a)(g,2),b=f[0],v=f[1],O=se(),j=Object(s.m)().id,C=Object(p.b)(),k=Object(s.k)(),N=Object(p.c)((function(e){return e.songs.find((function(e){return e.id===j}))})),S=Object(p.c)((function(e){return e.errors}));console.log("Errors:",S);var R=S.find((function(e){return e.type===J.c.SONG_TITLE_ERROR})),B=Object(p.c)((function(e){return e.snapshot}));Object(a.useEffect)((function(){C(Object(W.b)())}),[C]),console.log("Song render:",N);var w=function(){C(Object(W.c)(N)),C(Object(h.l)(N))},x=function(){n?L():T()},T=function(){C(Object(W.c)(N)),r(!0)},L=function(){console.log("Exiting edit mode"),G()?v(!0):(r(!1),C(Object(W.b)()))},_=function(){console.log("Saving!"),v(!1),r(!1),C(Object(W.b)()),C(Object(h.l)(N))},F=function(){console.log("Discarding changes!"),v(!1),r(!1),C(Object(h.j)(B)),C(Object(W.b)())},z=function(e){""===e.target.value||e.target.value.length>50?(console.log("Dispatching error"),C(Object(J.a)(J.c.SONG_TITLE_ERROR))):R&&(console.log("Removing errors"),C(Object(J.d)(J.c.SONG_TITLE_ERROR))),C(Object(h.i)(N,e.target.value))},V=function(){console.log("Add new section!"),C(Object(h.a)(N))},G=function(){return!ee.a.isEmpty(B)&&!ee.a.isEqual(B,N)};return N?o.a.createElement("div",{className:O.root},n?o.a.createElement("div",{style:{width:"".concat(5+N.title.length/2.5,"%")}},o.a.createElement(M.a,{fullWidth:!0,error:void 0!==R,className:O.titleField,label:"Edit title",defaultValue:N.title,onChange:z,helperText:R?"Length must be 1-50 characters":""})):o.a.createElement(D.a,{text:N.title}),o.a.createElement("div",null,o.a.createElement(l.a,{align:"right",maxWidth:!1,className:O.menuContainer},function(){if(G())return o.a.createElement(m.a,{color:"primary",variant:"outlined",onClick:w,disabled:0!==S.length},"Save changes")}(),o.a.createElement(m.a,{color:"primary",variant:"contained",onClick:x,className:O.editModeButton},n?"Exit edit mode":"Edit mode")),o.a.createElement(Z,{song:N,editMode:n})),o.a.createElement(l.a,{maxWidth:!1},n?o.a.createElement(m.a,{className:O.addSectionButton,variant:"contained",color:"primary",startIcon:o.a.createElement(I.a,null),onClick:V},"New section"):o.a.createElement("div",null)),o.a.createElement(l.a,{align:"right",maxWidth:!1},n?o.a.createElement(m.a,{className:O.deleteSongButton,variant:"contained",color:"secondary",startIcon:o.a.createElement(A.a,null),onClick:function(){return d(!0)}},"Delete song"):o.a.createElement("div",null)),o.a.createElement(y,{open:u,setOpen:d,handleConfirmClick:function(){console.log("Deleting song here"),C(Object(h.g)(N)),C(Object(W.b)()),k.push("/songs/")}}),o.a.createElement(ie,{open:b,setOpen:v,handleConfirmClick:_,handleDiscardClick:F,saveAllowed:0===S.length}),o.a.createElement(le,{handleSaveConfirmClick:_,handleSaveDiscardClick:F,unsavedChanges:G,saveAllowed:0===S.length})):o.a.createElement("div",null,o.a.createElement(D.a,{text:"Loading song"}),o.a.createElement("p",null,"Check the url if it takes too long"))},me=Object(c.a)((function(){return{mainContainer:{justifyContent:"center",alignItems:"center",padding:20},contentContainer:{}}}));t.default=function(){console.log("App rendering");var e=me(),t=Object(p.b)(),n=Object(p.c)((function(e){return e.auth.user}));return Object(a.useEffect)((function(){console.log("App effect"),t(Object(h.k)(n))}),[t,n]),o.a.createElement(o.a.Fragment,null,o.a.createElement(i.BrowserRouter,null,o.a.createElement(r.a,{loggedIn:!0}),o.a.createElement(l.a,{maxWidth:!1,className:e.mainContainer},o.a.createElement(l.a,{maxWidth:!1,align:"center",className:e.contentContainer},o.a.createElement(s.g,null,o.a.createElement(s.d,{path:"/songs/:id"},o.a.createElement(ue,null)),o.a.createElement(s.d,{path:"/songs/"},o.a.createElement(_,null)),o.a.createElement(s.d,{path:"/"},o.a.createElement("p",null,"Welcome")))))))}}}]);
//# sourceMappingURL=5.2724eaf0.chunk.js.map